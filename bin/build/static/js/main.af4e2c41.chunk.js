(this["webpackJsonpcollege-marketplace"]=this["webpackJsonpcollege-marketplace"]||[]).push([[0],{169:function(e,t,a){e.exports=a(290)},178:function(e,t){},180:function(e,t){},213:function(e,t){},214:function(e,t){},284:function(e,t,a){},290:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(20),c=a.n(r),o=a(11),i=a(6),m=a(299),u=a(163),s=a(296),d=a(162),E=a(164),p=a(13),b=a(44),f=Object(o.b)({key:"todoListState",default:[]}),g=Object(o.b)({key:"isAuthorizedState",default:!1}),h=Object(o.b)({key:"usernameState",default:""}),j=a(35),O=a(12),y=a(295),v=a(157),S=function(e){var t=e.show,a=e.handleClose,r=Object(o.e)(h),c=Object(o.e)(g),m=Object(n.useState)(!0),u=Object(i.a)(m,2),d=u[0],p=u[1],b=Object(n.useState)({}),f=Object(i.a)(b,2),S=f[0],k=f[1],w=Object(n.useState)(!1),C=Object(i.a)(w,2),N=C[0],I=C[1];return l.a.createElement(y.a,{show:t,onHide:a},l.a.createElement(y.a.Header,null,d?"Log in":"Sign up"),l.a.createElement(y.a.Body,null,l.a.createElement(s.a,{onChange:function(e){k(Object(O.a)({},S,Object(j.a)({},e.target.name,e.target.value)))},onSubmit:function(e){if(e.preventDefault(),e.stopPropagation(),!0===e.currentTarget.checkValidity()){I(!0);var t={email:S.email},n=Object(v.SHA256)(S.email+":"+S.password).toString();t.hash=n,d||(t.name=S.name),fetch(d?"marketplace-service/login":"marketplace-service/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){sessionStorage.setItem("username",e.name),r(e.name),sessionStorage.setItem("token",e.token),c(!0),I(!1),a()})).catch((function(e){alert("Invalid email/password!"),I(!1)}))}}},l.a.createElement(s.a.Group,{controlId:"email"},l.a.createElement(s.a.Label,null,"Email address"),l.a.createElement(s.a.Control,{required:!0,name:"email",type:"email",placeholder:"Enter email"}),l.a.createElement(s.a.Control.Feedback,{type:"invalid"},"Please enter a valid email")),d?"":l.a.createElement(s.a.Group,{controlId:"name"},l.a.createElement(s.a.Label,null,"Name"),l.a.createElement(s.a.Control,{name:"name",type:"text",placeholder:"Name"})),l.a.createElement(s.a.Group,{controlId:"password"},l.a.createElement(s.a.Label,null,"Password"),l.a.createElement(s.a.Control,{required:!0,name:"password",type:"password",placeholder:"Password"})),l.a.createElement(s.a.Row,{style:{alignItems:"center"}},l.a.createElement(E.a,{className:"mr-auto ml-1",variant:"primary",type:"submit",disabled:N},N?"Processing...":"Submit"),l.a.createElement("i",{className:"mr-1",style:{cursor:"pointer"},onClick:function(){return p(!d)}},l.a.createElement("u",null,d?"Don't have an account?":"Have an account?"))))))},k=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),j=Object(i.a)(c,2),O=j[0],y=j[1],v=Object(p.e)(),k=Object(o.e)(f),w=Object(o.d)(g),C=Object(o.d)(h);return l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,{bg:"primary",position:"static",variant:"dark",expand:!0},l.a.createElement(u.a,{md:3},l.a.createElement(m.a.Brand,{as:b.b,to:"/",className:"mr-auto"},"USC Marketplace")),l.a.createElement(u.a,{md:6},l.a.createElement(s.a,{inline:!0,className:"",onSubmit:function(e){e.preventDefault(),e.stopPropagation(),""!==O.trim()&&fetch("marketplace-service/search?q="+O.trim().replace(" ","%20")).then((function(e){return e.json()})).then((function(e){0!==e.length?k(e):alert("No results found!")}))}},l.a.createElement(d.a,{type:"text",style:{width:"90%",marginRight:"-5px"},placeholder:"Search",onChange:function(e){return y(e.target.value)}}),l.a.createElement(E.a,{variant:"primary",type:"submit",style:{width:"10%",marginLeft:"-5px",borderRadius:"0px"}},l.a.createElement("ion-icon",{name:"search-outline"})))),l.a.createElement(u.a,{md:3,style:{textAlign:"right"}},l.a.createElement(m.a.Text,{onClick:function(){w?v.push("/user"):r(!0)},style:{cursor:"pointer"}},w?C:"Log in"))),l.a.createElement(S,{show:a,handleClose:function(){return r(!1)}}))},w=(a(284),a(68)),C=a(291),N=a(292),I=a(293),P=a(69),L=function(e){var t=e.item,a=e.handleClick,r=Object(n.useState)(!1),c=Object(i.a)(r,2),m=c[0],u=c[1],s=Object(o.d)(g),d=Object(n.useState)(!1),p=Object(i.a)(d,2),b=p[0],f=p[1];return l.a.createElement(P.a,{style:{marginTop:30,marginLeft:15,marginRight:15,cursor:"pointer"},onClick:function(){return a(t.itemid)},onMouseEnter:function(){return u(!0)},onMouseLeave:function(){return u(!1)}},l.a.createElement("div",{className:"square",style:{backgroundImage:"url(".concat(t.pic,")")}},s?l.a.createElement("div",{className:"cardImageOverlay"},m?l.a.createElement(E.a,{style:{position:"absolute",top:0,right:0,borderRadius:10,marginTop:5,marginRight:5},onClick:function(e){e.stopPropagation(),f(!0)},disabled:b},b?"Pending":"Buy"):""):""),l.a.createElement(P.a.Body,null,l.a.createElement(P.a.Title,{style:{marginTop:10}},"$",t.price),l.a.createElement(P.a.Text,{style:{marginBottom:10}},t.name)))},x=a(298),T=function(e){var t=e.itemid,a=e.close,r=Object(n.useState)(!1),c=Object(i.a)(r,2),m=c[0],s=c[1],d=Object(n.useState)(null),p=Object(i.a)(d,2),b=p[0],f=p[1],h=Object(o.d)(g),j=Object(n.useState)(!1),O=Object(i.a)(j,2),v=O[0],S=(O[1],b&&b.image.map((function(e,t){return l.a.createElement(x.a.Item,{key:t},l.a.createElement("img",{className:"d-block w-100",src:e,alt:t}))}))),k=function(){return l.a.createElement("div",{className:"modal-close-button",onClick:a},l.a.createElement("ion-icon",{style:{fontSize:64},name:"close-outline"}))};return Object(n.useEffect)((function(){-1!==t&&fetch("marketplace-service/item/"+t).then((function(e){return e.json()})).then((function(e){f(e),s(!0)}),(function(e){alert("Loading failed",e),a()}))}),[t,a]),l.a.createElement(y.a,{show:-1!==t,onHide:a,animation:!1,dialogAs:"div"},l.a.createElement(k,null),m?l.a.createElement(C.a,{fluid:!0},l.a.createElement(N.a,null,l.a.createElement(u.a,{md:8},l.a.createElement(x.a,{interval:null,slide:!1,className:"carousel-container"},S)),l.a.createElement(u.a,{md:4},l.a.createElement(C.a,{fluid:!0,className:"desc-container"},l.a.createElement("h2",null,l.a.createElement("b",null,b.name)),l.a.createElement("h4",null,"$",b.price),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Details")),l.a.createElement("p",null,b.description),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Seller")),l.a.createElement("p",null,l.a.createElement("b",null,b.seller)),h?l.a.createElement(E.a,{className:"buy-button",disabled:v},v?"Pending":"Buy now"):l.a.createElement(E.a,{disabled:!0,className:"buy-button"},"Log in to buy"))))):l.a.createElement(I.a,{animation:"border",variant:"primary",className:"loading-spinner"}))},G=function(){var e=Object(n.useState)(-1),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(o.c)(f),m=Object(i.a)(c,2),s=m[0],d=m[1],p=Object(n.useState)(1),h=Object(i.a)(p,2),j=h[0],O=h[1],y=Object(o.d)(g),v=function(e){r(e)};Object(n.useEffect)((function(){fetch("marketplace-service/items").then((function(e){return e.json()})).then((function(e){return d(e)}))}),[]);var S=function(e){O(e),window.scrollTo(0,0)},k=s&&s.slice(20*(j-1),20*j).map((function(e){return l.a.createElement(u.a,{key:j+"."+e.itemid},l.a.createElement(L,{item:e,handleClick:v}))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(C.a,{fluid:"lg",className:"my-4"},y?l.a.createElement(E.a,{as:b.b,to:"/create"},"Create new listing"):"",0!==s.length?l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a,{xs:2,md:4},k),1!==j?l.a.createElement(E.a,{onClick:function(){return S(j-1)},className:"mr-3"},"Previous"):"",j!==Math.ceil(s.length/20)?l.a.createElement(E.a,{onClick:function(){return S(j+1)}},"Next"):""):l.a.createElement(I.a,{animation:"border",variant:"primary",className:"loading-spinner"})),l.a.createElement(T,{itemid:a,close:function(){r(-1)}}))},F=a(297),q=a(294),D=function(){var e=Object(n.useState)("profile"),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(o.d)(h),m=Object(n.useState)(""),d=Object(i.a)(m,2),p=d[0],b=d[1],f=Object(n.useState)([]),g=Object(i.a)(f,2),j=g[0],O=g[1],y=Object(n.useState)(-1),v=Object(i.a)(y,2),S=v[0],k=v[1];Object(n.useEffect)((function(){fetch("marketplace-service/user?token="+sessionStorage.getItem("token")).then((function(e){return e.json()})).then((function(e){console.log(e),b(e.profile.email),O(e.orders)}))}),[]);var w=function(e){return e.map((function(e){return l.a.createElement("tr",{key:e.itemid,onClick:function(){return t=e.itemid,k(t);var t},style:{cursor:"pointer"}},l.a.createElement("td",null,e.name),l.a.createElement("td",null,"$",e.price),l.a.createElement("td",null,e.seller),l.a.createElement("td",null,e.status?"Complete":"Pending"))}))};return l.a.createElement(l.a.Fragment,null,l.a.createElement(N.a,{className:"mt-5"},l.a.createElement(u.a,{md:{span:2,offset:1}},l.a.createElement(F.a,{variant:"pills",defaultActiveKey:"profile",className:"flex-column",onSelect:function(e){return r(e)}},l.a.createElement(F.a.Item,null,l.a.createElement(F.a.Link,{eventKey:"profile"},"Profile")),l.a.createElement(F.a.Item,null,l.a.createElement(F.a.Link,{eventKey:"orders"},"My Orders")))),l.a.createElement(u.a,{md:{span:6},className:"ml-5"},"profile"===a?l.a.createElement(s.a,null,l.a.createElement(s.a.Group,{controlId:"email"},l.a.createElement(s.a.Label,null,"Email address"),l.a.createElement(s.a.Control,{type:"email",placeholder:"Enter email",defaultValue:p})),l.a.createElement(s.a.Group,{controlId:"name"},l.a.createElement(s.a.Label,null,"Name"),l.a.createElement(s.a.Control,{type:"email",placeholder:"Enter your name",defaultValue:c})),l.a.createElement(s.a.Group,{controlId:"password"},l.a.createElement(s.a.Label,null,"Password"),l.a.createElement(s.a.Control,{type:"password",placeholder:"Password"})),l.a.createElement(E.a,{variant:"primary",type:"submit"},"Save changes")):l.a.createElement(l.a.Fragment,null,l.a.createElement("h3",null,"Your purchases: "),l.a.createElement(q.a,null,l.a.createElement("thead",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Seller"),l.a.createElement("th",null,"Status")),l.a.createElement("tbody",null,w(j.buy))),l.a.createElement("h3",null,"Your listings: "),l.a.createElement(q.a,null,l.a.createElement("thead",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Price"),l.a.createElement("th",null,"Seller"),l.a.createElement("th",null,"Status")),l.a.createElement("tbody",null,w(j.sell)))))),l.a.createElement(T,{itemid:S,close:function(){return k(-1)}}))},A=function(){var e=Object(n.useState)({}),t=Object(i.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),o=Object(i.a)(c,2),m=(o[0],o[1]),u=Object(p.e)();return l.a.createElement(C.a,{fluid:"md",className:"mt-4"},l.a.createElement("h2",null,"Create new listing"),l.a.createElement(s.a,{onChange:function(e){console.log(e.target.name),"picture"===e.target.name?(console.log(e.target.files),r(Object(O.a)({},a,{pictures:e.target.files}))):r(Object(O.a)({},a,Object(j.a)({},e.target.name,e.target.value)))},onSubmit:function(e){if(e.preventDefault(),e.stopPropagation(),e.currentTarget.checkValidity()&&function(){var e=/[a-zA-Z0-9]+\.(jpg|png|jpeg)$/i;console.log(a.pictures);for(var t=0;t<a.pictures.length;t++)if(console.log(a.pictures[t].name),!e.test(a.pictures[t].name))return alert("Please upload valid pictures!"),!1;return!0}()){m(!0);var t=new FormData(e.target);fetch("marketplace-service/create",{method:"POST",body:t}).then((function(e){200===e.status?u.push("/"):alert("An error has occured.")}))}}},l.a.createElement(s.a.Group,{controlId:"title"},l.a.createElement(s.a.Label,null,"Title"),l.a.createElement(s.a.Control,{type:"text",name:"title",required:!0})),l.a.createElement(s.a.Group,{controlId:"price"},l.a.createElement(s.a.Label,null,"Price"),l.a.createElement(s.a.Control,{type:"number",name:"price",required:!0})),l.a.createElement(s.a.Group,{controlId:"picture"},l.a.createElement(s.a.File,{name:"picture",multiple:!0,required:!0,label:"Pictures"})),l.a.createElement(s.a.Group,{controlId:"description"},l.a.createElement(s.a.Label,null,"Description"),l.a.createElement(s.a.Control,{as:"textarea",rows:5,name:"description",required:!0})),l.a.createElement("input",{type:"hidden",name:"token",value:sessionStorage.getItem("token")}),l.a.createElement(E.a,{type:"submit"},"Submit")))};new FormData;var B=function(){var e=Object(o.d)(g);return l.a.createElement(w.a,{className:"p-0"},e&&l.a.createElement(w.a,null,l.a.createElement(p.a,{path:"/user"},l.a.createElement(D,null)),l.a.createElement(p.a,{path:"/create"},l.a.createElement(A,null))),l.a.createElement(p.a,{path:"/",exact:!0},l.a.createElement(G,null)))},M=a(84);var R=function(){var e=Object(o.e)(g),t=Object(o.c)(h),a=Object(i.a)(t,2),r=a[0],c=a[1],m=Object(M.useToasts)().addToast;return sessionStorage.getItem("token")&&(e(!0),c(sessionStorage.getItem("username"))),Object(n.useEffect)((function(){if(console.log("production"),""!==r){var e=new WebSocket("ws://localhost:8080/push_notification_v1/push/"+r);return e.onmessage=function(e){m(JSON.parse(e.data.msg),{appearance:"info"})},function(){e.close()}}}),[r]),l.a.createElement(b.a,{basename:"/marketplace-service"},l.a.createElement(k,null),l.a.createElement(B,null))};c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(o.a,null,l.a.createElement(M.ToastProvider,null,l.a.createElement(R,null)))),document.getElementById("root"))}},[[169,1,2]]]);
//# sourceMappingURL=main.af4e2c41.chunk.js.map